# **도커 컨테이너 만들기**

## `1.무엇을 컨테이너로 만들까`
___
애플리케이션이 운영되기 위해선 운영 환경이 필요하다
예를 들어, 
빅데이터 알고리즘을 지원해주는 프로그램있다면:
* 운영 환경으로 파이썬도 필요할 거고
* 파이썬 위에 설치되어 있는 텐서플로우라는 것도 필요할 것이다.
* 그리고 빅데이터와 관련된, 어떤 빅데이터를 처리해주는 소스 코드 파이썬 소스코드를 올리고 
* 그리고 이 컨테이너를 동작해서 자동으로 자동으로 실행할 명령어를 넣어주는 것이다.

이렇게 묶어 놓은 것들의 하나의 독립된 공간을 (다시한번 말하지만) 컨테이너라고 한다. 

그럼 back단에서 운영되는 어떤 노드 js 애플리케이션을 보자:

* 그럼 먼저 운영환경이 필요합니다 - `nodejs!` 
> 왜? 이 소스 코드가 nodejs 소스코드인데 nodejs가 없으면 이 소스코드를 해석 할 수 없기 때문!

* 그리고 여기에 소스코드가 들어가고
* 이 컨테이너를 실행할 때 자동으로 동작시켜 줄 명령어를 넣어주면 

하나의 애플리케이션 컨테이너가 독립된 공간으로 만들어지는 것이다.
이렇게 독립된 공간으로 만들어진 컨테이너를 도대체 무엇으로 사용할까? 그리고 어떻게 사용할까?
바로 *`(ployglot)`*이라는 형태로 쓰게 된다.

++ Ployglot Programming 다양한 언어를 사용하여 프로그래밍 하는 것!

백단에서 처리할때 적합한 랭귀지 프론트단을 처리할 때 적합한 랭귀지가 다 다르다
그러한 프로그래밍 랭귀지들이 하나의 e commerce 플랫폼을 구현하는데 

어떤 쇼핑카트라고 하는 컨테이너를 만들 때는 *JAVA*로

컴플릿 오더스라고 하는 컨테이너를 만들 때는 *php*로

인벤토리 그리고 아이템 가격에 대한 컨테이너를 만들 때는 *Nodejs*로

등등 이렇게 다양한 랭귀지를 이용해서 그 애플리케이션을 구현하는데 가장 적합한 랭귀지를 구현 선택을 해서
하나의 플랫폼들을 구현할 수가 있다.

그래서 전체 이커머스들을 구현하는데 지금 다양한 컨테이너들을 가지고 
* 쇼핑카트 
* 오더서비스 
* 아이템 관리 
* 고객관리
* 상품관리

적재적소에 맞는 데이터베이스 거기에 맞는 키벨류 데이터베이스 이런것들을 컨테이너화 시켜서 만들어주는 것이다.

이렇게 만들어진 컨테이너는 예를 들어서 *쇼핑카트에다 이러이러한 기능이 추가되었으면 좋겠어* 그러면 `쇼핑카트만` 추가 코딩 `유지보수가 가능하게 해준다`.

해당 컨테이너만! 보면 다른컨테이너는 영향을 주지 않고 독립된 공간으로 서비스가 되는 것이다. 어떻게? 네트워크을 통해서! 이렇게 운영하는 플랫폼중에 MSA라는 것이있다(+ 요즘의 트렌드이다.)  

### 고객의 요구에 바로바로 대응할수 있고 
그래야지 
### 상품을 더 많이 서비스 해줄수 있고

### 짧은 라이프 사이클에 대응할수 있다 

따라서 컨테이너는 각각의 `application service에 맞춰 container를 만들어 낸다!`

## `2.어떻게 컨테이너를 만들까? Dockerfile이란?`
___
컨테이너 어떻게 만들까? 그리고 도커파일이란 무엇을 말하는 것일까?

도커파일은 컨테이너를 만들수 있도록 도와주는 명령어 집합이다

일단 빌드 명령어

``` shell
$mkdir build 
$cd build
$vi dockerfile <-여기에 도커 명령어 집합 넣어주고
$docker build -t imagename:tag . <-해당 도커파일 실행
```
마지막 명령어는 도커파일을 'top to down' 형식으로 한줄한줄 해석하면서 컨테이너를 만들어준다

이름은 -t imagename 콜론 뒤에해당하는 네임으로 만들어진다 

이렇게만 보면 꽤 쉬워보인다(물론 기본적인 shell script를 안다는 가정하에..) 

ㅁ  
  
도커 파일 자체는 그렇게 복잡하고 컨테이너 만드는 작업이 어렵고 복잡한건 아니다

다만이제 어떤 형태를 우리가 이런 컨테이너를 만들어 낼 것인지를 먼저 기획을 하고 그런 다음에 이것들을 하나하나의 컨테이너로 만들어내는 작업을하는 것이다
정리하자면, `Dockerfile은 바로 컨테이너를 빌드 하도록 도와주는 그러한 명령어들의 집합`이다 

도커파일 쉽고 간단하다. 명확한 구문을 가지고 있으며, 그저 `텍스트 파일`이다.
`탑다운으로 해석`을 해주며 컨테이너의 `이미지를 생성 할 수 있는 고유의 지시어들을 가지고` 있습니다
`대소문자를 구분하진 않는다` 이 지시어가 소문자여도 되고 대문자여도 되는데 
다만 대문자로 써놓으면 우리가 사용하는 명령어들과 구분을 지어줄수 있기때문에 한마디로 가독성을 위하여 구분해서 기입해놓는다.




## `3. 만들어진 컨테이너 배포방법`
___
이렇게 만들어진 컨테이너 어떻게 할까? 배포 해야하지 않겠는가?
우리 운영환경에서 도커컨테이너에서 실행되게 하던지 아니면 고객사에게 제공해 주든지 하면 된다.
그럴려면 내가만든 컨테이너를 배포해야 한다.


`도커 호스트`가 `도커 허브`가 키워드이다. 퍼블릭 공간이나 프라이빗 공간의 허브 일 수 있다
컨테이너를 모아두는 허브가 있어요

앞전에 무엇을 컨테이너를 만들 것인지 구상 했고 기획을 했다. 
그다음에 컨테이너를 만들었다. 어떻게 도커 빌드라는 명령어로 `imagename:tag` 컨테이너로 만든거죠
그리고 어떻게 되었는가? 이미지화 되어있는 컨테이너가 하드디스크에 저장되었다.

그럼 이 컨테이너를 어떻게 해야하냐면 

배포 해야 되겠죠?

다른 사람들이 쓸 수 있도록 제공해줘야 한다. 허브에 넣어두면 쓸 수 있는 환경이 되는 것이다.

허브에 넣기 위해서는 어떻게 합니까?
* 프라이빗 공간이든 퍼블릭 공간이든 아무나 허브에다가 컨텐츠를 못 넣기때문에 허가부터 받아야 한다
* 인증을 받은 다음에(허브에서 허가받은 유저의 username과 password를 넣어서 인증 받은 다음에)  
* 도커 푸쉬라는 명령, 앞서서 만들어 놨던 이미지를 ```push``` 해주면 

내가 만든 호스트, 도커 호스트에 있는 컨테이너 이미지 모드로 허브에 저장되게 됩니다
이렇게 해주면 그 컨테이너는 다른 사람이 쓸 수 있게 된다.

자 이걸 이제 다른 고객사가 됐든 우리 회사의 어떤 컨테이너 기반의 애플리케이션 운영자가 됐든 그들이 쓸 수 있게 되는것이다. 이렇게 운영하는걸 가지고 우리는 `컨테이너 배포한다`라고 한다. 

### **- 추가 내용**

> 허브에 가서 도커파일을 참고하고 자주 읽어보기