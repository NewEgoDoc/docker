# **컨테이너 살펴보기**


## `1.컨테이너와 컨테이너 이미지`
___
컨테이너는 하나의 어플리케이션이라고 생각하면 편하다.

Nodejs 컨테이너, php기반의 어플리케이션 컨테이너, mysql db 컨테이너

이렇게 컨테이너가 동작중이라면 하나의 컨테이너 플랫폼에서 애플리케이션이 독립된 공간에서 분리되서 운영된다. 다시말하면, cpu 메모리 네트웍 디스크 이러한 하드웨어 리소스를 각각 따로 가지고 있다는 것이다. 이것이 일반 애플리케이션과 컨테이너 기반 애플리케이션의 차이이다.

프론트 단에서 nodejs는 php나 mysql에 동작되면서 전혀 영향을 주지 않는다 그래서 고객이 웹서버에 요구사항을 적용하면 개발자는 front단의 애플리케이션만 편집하고 수정 추가 배포가 가능한 것이다. 

아~ 컨테이너는 하나하나가 독립적인 어플리케이션이구나~ 까지는 어느정도 알겠다.

그럼 어떻게 동작할까?

예를 들어서 프론트 단에서 실행하고 있는 노드js의 애플리케이션 하나를 실행한다고 보자

nodejs의 환경을 구축해주고 해당에 관련된 코드를 쭉~ 나열
예제로 expressjs에서 제공해주는 Hello World를 썻다.

```javascript
const express = require('express')
const app = express()
const port = 3000

app.get('/', (req, res) => {
  res.send('Hello World!')
})

app.listen(port, () => {
  console.log(`Example app listening at http://localhost:${port}`)
})
```
여러개를 쌓았기 때문에 우리는 레이어라고 구분을 하고 베이스 이미지라고 부른다.
맨아래층 하나는 하나의 이미지이다. 근데 이제 uuid를 곁들인...

nodejs를 베이스 이미지 설비, 환경설비로 했고 두번째 레이어에서 app.js(expressjs를 사용한) 소스 이미지 그리고 세번째 레이어에서 동작시키는 방법을 나열하였다.
이렇게 첫번째 두번째 세번째 레이어 세개의 레이어를 가지고 만들어진 컨테이너이다.

이것을 좀더 시스템 관점으로 보자
우리는 노드 js라고 하는데 시스템은 이걸 저장할때 uuid로 저장해 준다

이시스템관점으로보든 추상이미지로보든 이러한 여러 레이어가 모여있는 형태를 container image라고 한다.
요게바로 컨테이너 이미지이며 컨테이너 이미지는 여러개의 레이어로 구성이 되서 1개이상 10개 20개 n개의 레이어일 수 있다.
여러개의 레이어로 구성을 해서 하나의 애플리케이션이 잘 실행될수 있도록 모아져있는 이미지들의 조합이 하나의 컨테이너 이미지가 된다.
이런건 어떻게 만들까? 나중에 우리가 빌드할 때 우리가 이 구조대로 빌드를 해야한다, 컨테이너를 만들때, 이구조를 먼저 알고 잇으면 빌드하기가 더 쉽단 얘기이다.

## `2.컨테이너와 컨테이너 이미지 차이점`
___
도커 호스트가 있구요 여기에는 당연히 도커 데몬이 동작중이다.
그리고 또 누가 있냐면 컨테이너 이미지가 저장이 된다.
컨테이너 이미지는 이렇게 하드디스크에 하나의 파일 형태로 저장이 되어있다
각각의 레이어 별로 파일이 따로따로 존재한다.
이렇게 파일로 저장되어 있는 저장된 상태 이걸 가지고 우리는 뭐라고 하냐면 '컨테이너 이미지'라고 한다
아 근데 이 컨테이너 이미지를 그냥 둔게 아니라, 실행을 하는 거죠
실행을 하게 되면 메모리에 컨테이너로 하나의 애플리케이션 프로세스로 러닝 중이게 되고
이걸가지고 우리는 컨테이너라고 한다.
디스크에 저장되어있는건 컨테이너 이미지이다. 하지만 메모리에 적재되어 실행중인 컨테이너 이미지 프로세스는 컨테이너라고 부른다.
엄밀히 말하면 컨테이너 이미지는 읽기만 가능하다 하지만 컨테이너는 읽기 쓰기 전부 가능하다.
동작중인 호스트 입장에선 단순하게 동작중인 프로세스일 뿐이다

컨테이너 이미지는 파일 형태로 저장되어 있고 컨테이너는 실행중인 프로세스가 된다.



## `3. Dokcer의 기능`
___
컨테이너 동작방식:
* 도커 호스트가 있고 도커 허브가있다
* 수많은 컨테이너가 도커 허브에 있다.
* 도커 닷컴에 도커 허브 닷컴에 10만여개의 컨테이너가 있음
* 도커 데몬이 동작중
* 도커 클라이언트 명령 실행 가능, 데몬에게 명령을 요청
* 도커 search 커맨드를 데몬에게 요청
* 도커 허브에서 nginx 있는지 찾아봐주셈 하는것이다.
* $docker search nginx
* $docker pull nginx:latest
* 이렇게 이미지를 하드디스크로 가져온다.
* 실제로는 레이어가 여러개 있을것이다.
* 예를 들어 5개의 레이어가 있으면 5개의 폴더를 가지고 파일을 저장하고 있다
* 다운로드 받은 이미지는 하나이지만 그안에 레이어별로 파일이 따로따로 있다
* 이게바로 컨테이너 이미지가 됩니다
* 로컬에 있는 이미지구요 허브에 있는 이미지들이구요 이렇게 되는거죠

* 아직은 컨테이너가 아니다.
* 이걸 컨테이너화 시킬려면 도커 run 명령어로 실행해야한다.
* $docker run -d --name web -p 80:80 nginx:latest
* 물론 런 대신에 create,start 해도 된다. - 추후에 해당 명령어의 차이점을 관찰해보자
___
### **- 용어정리**

> 용어 정리
```
docker host(linux kernel)
docker daemon: systemctl start docker
docker clinent commnad: docker
docker hub
container image
container

$docker search nginx
$docker pull nginx:latest
```

